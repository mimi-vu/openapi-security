<!DOCTYPE html>
<html>
<head>
    <title>Security Analysis Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">

<h2>Security Analysis Results</h2>

<!-- Score -->
<div class="card mb-4">
    <div class="card-body">
        <h4>Security Score: 
            <span class="badge bg-dark">{{ score }}/100</span>
        </h4>
        <p>Total Issues: <strong>{{ total }}</strong></p>
    </div>
</div>

<!-- Severity Breakdown -->
<div class="row mb-4">
    <div class="col">
        <div class="alert alert-danger">
            Critical: {{ summary["Critical"] }}
        </div>
    </div>
    <div class="col">
        <div class="alert alert-warning">
            High: {{ summary["High"] }}
        </div>
    </div>
    <div class="col">
        <div class="alert alert-info">
            Medium: {{ summary["Medium"] }}
        </div>
    </div>
    <div class="col">
        <div class="alert alert-secondary">
            Low: {{ summary["Low"] }}
        </div>
    </div>
</div>

<!-- Issue List -->
<h4>Detailed Findings</h4>

{% if issues %}
    {% for issue in issues %}
        <div class="card mb-3">
            <div class="card-body">
                <h5>
                    {{ issue.rule_id }}
                    {% if issue.severity == "Critical" %}
                        <span class="badge bg-danger">Critical</span>
                    {% elif issue.severity == "High" %}
                        <span class="badge bg-warning text-dark">High</span>
                    {% elif issue.severity == "Medium" %}
                        <span class="badge bg-info text-dark">Medium</span>
                    {% else %}
                        <span class="badge bg-secondary">Low</span>
                    {% endif %}
                </h5>
                <p><strong>Message:</strong> {{ issue.message }}</p>
                <p><strong>Location:</strong> <code>{{ issue.location }}</code></p>
            </div>
        </div>
    {% endfor %}
{% else %}
    <div class="alert alert-success">
        No security issues found!
    </div>
{% endif %}

<a href="/" class="btn btn-primary mt-3">Analyze Another Spec</a>

</body>
</html>
